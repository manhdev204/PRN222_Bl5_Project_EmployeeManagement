@model IEnumerable<PRN222_BL5_Project_EmployeeManagement.Models.Account>
@{
    ViewData["Title"] = "Accounts";
}
<h2>Accounts</h2>
<form method="get" class="row g-3 mb-3 align-items-end">
    <div class="col-md-3">
        <label class="form-label">Search: Username</label>
        <input class="form-control" type="text" name="username" value="@ViewBag.Username" placeholder="Username" />
    </div>
    <div class="col-md-3">
        <label class="form-label">Search: Full name</label>
        <input class="form-control" type="text" name="fullName" value="@ViewBag.FullName" placeholder="Full name" />
    </div>
    <div class="col-md-3">
        <label class="form-label">Search: Email</label>
        <input class="form-control" type="text" name="email" value="@ViewBag.Email" placeholder="Email" />
    </div>
    <div class="col-md-3">
        <label class="form-label">Search: Phone</label>
        <input class="form-control" type="text" name="phone" value="@ViewBag.Phone" placeholder="Phone" />
    </div>
    <div class="col-md-3">
        <label class="form-label">Filter: Department</label>
        <select class="form-select" name="departmentId">
            <option value="">All Departments</option>
            @foreach (var d in (IEnumerable<PRN222_BL5_Project_EmployeeManagement.Models.Department>)ViewBag.Departments)
            {
                var selected = (int?)ViewBag.SelectedDepartmentId == d.DepartmentId;
                <option value="@d.DepartmentId" selected="@selected">@d.DepartmentName (@d.DepartmentId)</option>
            }
        </select>
    </div>
    <div class="col-md-3">
        <label class="form-label">Filter: Role</label>
        <select class="form-select" name="roleId">
            <option value="">All Roles</option>
            @foreach (var r in (IEnumerable<PRN222_BL5_Project_EmployeeManagement.Models.Role>)ViewBag.Roles)
            {
                var selected = (int?)ViewBag.SelectedRoleId == r.RoleId;
                <option value="@r.RoleId" selected="@selected">@r.RoleName (@r.RoleId)</option>
            }
        </select>
    </div>
    <div class="col-md-2">
        <label class="form-label">Order by</label>
        <select class="form-select" name="sortField">
            <option value="account_id" selected="@((string)ViewBag.SortField=="account_id")">Account ID</option>
            <option value="username" selected="@((string)ViewBag.SortField=="username")">Username</option>
            <option value="created_date" selected="@((string)ViewBag.SortField=="created_date")">Created Date</option>
            <option value="last_updated_date" selected="@((string)ViewBag.SortField=="last_updated_date")">Last Updated</option>
        </select>
    </div>
    <div class="col-md-2">
        <label class="form-label">Direction</label>
        <select class="form-select" name="sortDir">
            <option value="asc" selected="@((string)ViewBag.SortDir=="asc")">Asc</option>
            <option value="desc" selected="@((string)ViewBag.SortDir=="desc")">Desc</option>
        </select>
    </div>
    <div class="col-md-2 d-grid">
        <button class="btn btn-outline-primary" type="submit">Search</button>
    </div>
</form>
<div class="mb-3">
    <a class="btn btn-primary" asp-controller="AdminAccounts" asp-action="Create">Create New</a>
    <a class="btn btn-outline-secondary" asp-controller="AdminDepartments" asp-action="Index">Manage Departments</a>
    <a class="btn btn-outline-secondary" asp-controller="AdminRoles" asp-action="Index">Manage Roles</a>
    </div>
<table class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Full Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Role</th>
            <th>Department</th>
            <th>Delete Flag</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var a in Model)
        {
            <tr>
                <td>@a.AccountId</td>
                <td>@a.Username</td>
                <td>@a.FullName</td>
                <td>@a.Email</td>
                <td>@a.Phone</td>
                <td>@a.Role?.RoleName (@a.RoleId)</td>
                <td>@a.Department?.DepartmentName (@a.DepartmentId)</td>
                <td>@(a.DeleteFlag == true ? "Yes" : "No")</td>
                <td>
                    <a class="btn btn-sm btn-outline-primary" asp-controller="AdminAccounts" asp-action="Edit" asp-route-id="@a.AccountId">Edit</a>
                </td>
            </tr>
        }
    </tbody>
    </table>


